# Универсальные принципы адаптивного отображения таблиц в админ-панели

Этот документ определяет универсальные принципы и подходы к созданию адаптивных таблиц в админ-панели проекта. Принципы применимы ко всем таблицам (Services, Orders, FAQ, Gallery, Reviews) и обеспечивают консистентный UX на всех устройствах.

**Версия документа**: 1.0  
**Дата создания**: 06.11.2025  
**Применимость**: Все таблицы в админ-панели

---

## 1. Брейкпоинт и медиа-запросы

### 1.1. Единый брейкпоинт
- **Брейкпоинт**: 1280px (Tailwind: `xl:`)
- **Мобильная версия**: < 1280px (до `xl:`)
- **Десктопная версия**: ≥ 1280px (`xl:` и выше)

### 1.2. Использование в коде
```typescript
// Десктопная версия (скрыта на мобильных)
<div className="hidden xl:block">
  {/* Desktop table */}
</div>

// Мобильная версия (скрыта на десктопе)
<div className="xl:hidden">
  {/* Mobile table */}
</div>
```

---

## 2. Структура данных строки

Каждая строка таблицы должна иметь четкое разделение на логические секции:

### 2.1. Основная информация
- Идентифицирующая информация
- Приоритетные поля для быстрого понимания сущности
- **Примеры**: название услуги, номер заказа, имя клиента, заголовок FAQ

### 2.2. Детальная информация
- Дополнительная информация о сущности
- Вторичные поля
- **Примеры**: описание, цена, статус, дата создания, метаданные

### 2.3. Действия и управление
- Интерактивные элементы управления
- Кнопки действий (редактирование, удаление, просмотр)
- Статусы и бейджи, требующие действий

---

## 3. Десктопная версия (≥ 1280px)

### 3.1. Структура таблицы
- Использование стандартной HTML-таблицы (`<table>`, `<thead>`, `<tbody>`, `<tr>`, `<td>`)
- Все колонки видны одновременно
- Горизонтальная прокрутка нежелательна (при необходимости — адаптация колонок)

### 3.2. Колонки таблицы (порядок слева направо)
1. **Drag & Drop Handle** (фиксированная узкая колонка, `w-10`)
2. **Номер элемента** (фиксированная узкая колонка, `w-12`) — заменяет колонку "Порядок"
3. **Основные колонки данных** (название, описание, цена и т.д.)
4. **Колонка действий** (справа)

### 3.3. Колонка номера элемента
- **Ширина**: фиксированная, узкая (примерно `w-12` или `w-16`)
- **Содержимое**: порядковый номер элемента (начиная с 1 или 0)
- **Выравнивание**: по центру (`text-center`)
- **Стилизация**: `text-muted-foreground`, `font-medium`
- **Назначение**: визуальная индикация позиции элемента в списке
- **Важно**: Колонка "Порядок" не должна присутствовать в таблице, так как номер элемента заменяет её

### 3.4. Колонка описания
- **Ширина**: ~35 символов (примерно `ch` или фиксированная ширина)
- **Перенос текста**: `whitespace-normal` (не `truncate`)
- **Многострочное отображение**: `line-clamp-2` или `line-clamp-3` для ограничения высоты
- **CSS**: `max-width: 35ch; word-wrap: break-word;`

**Пример:**
```tsx
<TableCell className="max-w-[35ch] whitespace-normal">
  {service.shortDescription}
</TableCell>
```

### 3.5. Drag & Drop на десктопе
- Handle в первой колонке (иконка `GripVertical`)
- Визуальная обратная связь при перетаскивании (opacity, background)
- Сохранение порядка через `@dnd-kit/core` и `@dnd-kit/sortable`
- Номер элемента обновляется автоматически при изменении порядка

### 3.6. Wireframe десктопной строки таблицы

```
┌──────────┬──────┬──────────────┬──────────────────────────┬──────────┬──────────┬──────────┬──────────┐
│ [::: ]   │  1   │ Название     │ Описание (35 символов,   │ Цена     │ Единица  │ Активность│ Действия │
│          │      │              │ перенос текста)          │          │          │          │          │
└──────────┴──────┴──────────────┴──────────────────────────┴──────────┴──────────┴──────────┴──────────┘
   Handle    №     Основная      Детальная информация       Метаданные  Метаданные  Статус     Кнопки
   (w-10)  (w-12)  информация
```

**Пример для таблицы услуг:**
```
┌──────────┬──────┬──────────────────────┬──────────────────────────┬──────────┬──────────┬──────────┬──────────┐
│ [::: ]   │  1   │ Установка            │ Установка люстр, бра,    │ 50.00    │ шт       │ [Активна]│ [✏️][🗑️]│
│          │      │ светильников         │ точечных светильников    │ BYN      │          │          │          │
└──────────┴──────┴──────────────────────┴──────────────────────────┴──────────┴──────────┴──────────┴──────────┘
```

---

## 4. Мобильная версия (< 1280px)

### 4.1. Структура двухколоночной таблицы
На мобильных экранах таблица состоит из двух колонок:

```
┌─────────┬────────────────────────────────────┐
│ [Handle]│ Информация и действия              │
│         │                                    │
│         │ - Основная информация (с номером)  │
│         │ - Детальная информация            │
│         │ - Действия (только иконки)         │
└─────────┴────────────────────────────────────┘
```

### 4.2. Первая колонка: Drag & Drop Handle
- **Ширина**: фиксированная, узкая (примерно `w-5` - уменьшена в 2 раза по сравнению с десктопом)
- **Содержимое**:
  - Иконка `GripVertical` для перетаскивания
  - Touch-friendly размер (минимум 44x44px для touch-устройств)
- **Стилизация**:
  - `cursor-grab active:cursor-grabbing`
  - `touch-none` для предотвращения конфликтов с прокруткой
  - Центрирование иконки: `flex items-center justify-center`
  - Padding: `p-1` для компактности
  - **Важно**: Добавить `suppressHydrationWarning` для предотвращения hydration mismatch с dnd-kit

**Пример:**
```tsx
<TableCell className="w-5">
  <button
    {...attributes}
    {...listeners}
    className="cursor-grab active:cursor-grabbing touch-none p-1 hover:bg-muted rounded flex items-center justify-center"
    aria-label="Переместить элемент"
    suppressHydrationWarning
  >
    <GripVertical className="h-4 w-4 text-muted-foreground" />
  </button>
</TableCell>
```

### 4.3. Вторая колонка: Информация и действия
- **Ширина**: оставшееся пространство (`flex-1` или `w-full`)
- **Структура содержимого** (вертикальное расположение):
  
  **4.3.1. Основная информация (верх)**
  - **Номер элемента** должен быть включен в заголовок элемента (например, "1. Название услуги")
  - Ключевые идентификаторы (название, заголовок)
  - Статусные бейджи (если критичны для идентификации)
  - Стилизация: `font-semibold`, `text-base` или `text-lg`
  - **Важно**: Номер элемента НЕ должен быть отдельной колонкой, он должен быть частью заголовка
  - **Расположение заголовка и статуса**: По умолчанию должны располагаться в колонку (`flex-col`), а не в строку, чтобы статус переносился на следующую строку, если не помещается
  - **Перенос содержимого**: Все элементы должны переносить содержимое на следующую строку, если не помещается в контейнер
  
  **4.3.2. Детальная информация (середина)**
  - Все остальные поля из таблицы
  - **Описание**: 
    - Максимальная ширина: ~35 символов (примерно `max-w-[35ch]`)
    - Может быть меньше, если не помещается в контейнер
    - Текст должен переноситься на следующую строку естественным образом
    - Использовать `whitespace-normal` и `word-wrap: break-word`
  - Метаданные (даты, цены, единицы измерения)
  - Стилизация: `text-sm`, `text-muted-foreground`, ключ-значение парами
  - Формат: `<div><span className="font-medium">Ключ:</span> Значение</div>`
  - **Перенос содержимого**: Каждый элемент должен переносить содержимое на следующую строку, если не помещается
  
  **4.3.3. Действия (низ)**
  - Кнопки действий содержат **только иконки**, без текста
  - Кнопки редактирования и удаления должны быть компактными
  - Статусные бейджи (если не в основной информации)
  - Дополнительные интерактивные элементы
  - Стилизация: `flex items-center gap-2`

**Пример структуры:**
```tsx
<TableCell className="flex-1">
  <div className="flex flex-col space-y-3">
    {/* Основная информация с номером в заголовке */}
    {/* Заголовок и статус в колонку для автоматического переноса */}
    <div className="flex flex-col gap-2">
      <div className="font-semibold text-lg">
        {index + 1}. {service.name}
      </div>
      <Badge variant={service.active ? 'default' : 'secondary'} className="w-fit">
        {service.active ? 'Активна' : 'Неактивна'}
      </Badge>
    </div>
    
    {/* Детальная информация */}
    <div className="space-y-2 text-sm">
      <div>
        <span className="font-medium">Описание:</span>{' '}
        <span className="max-w-[35ch] whitespace-normal break-words">
          {service.shortDescription}
        </span>
      </div>
      <div>
        <span className="font-medium">Цена:</span>{' '}
        {parseFloat(service.price).toFixed(2)} BYN
      </div>
      <div>
        <span className="font-medium">Единица:</span> {service.unit}
      </div>
    </div>
    
    {/* Действия - только иконки */}
    <div className="flex items-center gap-2">
      <Button size="sm" variant="outline" asChild>
        <Link href={`/admin/dashboard/services/${service.id}/edit`}>
          <Edit className="h-4 w-4" />
        </Link>
      </Button>
      <Button size="sm" variant="destructive" onClick={() => handleDelete(service.id)}>
        <Trash2 className="h-4 w-4" />
      </Button>
    </div>
  </div>
</TableCell>
```

### 4.5. Вертикальное расположение информации
- Использование `flex flex-col` для третьей колонки
- Отступы между секциями: `space-y-2` или `space-y-3`
- Визуальное разделение: границы или отступы между логическими группами

### 4.6. Drag & Drop на мобильных
- Handle всегда доступен в первой колонке
- Использование тех же библиотек (`@dnd-kit/core`, `@dnd-kit/sortable`)
- Touch-friendly: достаточный размер handle, `touch-none` для предотвращения конфликтов
- Визуальная обратная связь: изменение opacity, border при перетаскивании
- Сохранение функциональности: та же логика переупорядочивания, что и на десктопе
- Номер элемента обновляется автоматически при изменении порядка
- **Важно**: Использовать `suppressHydrationWarning` на элементах с dnd-kit для предотвращения hydration mismatch

### 4.7. Адаптивность содержимого
- **Перенос содержимого**: Все элементы должны переносить содержимое на следующую строку, если не помещается в контейнер
- **Описание**: 
  - Максимальная ширина: ~35 символов (`max-w-[35ch]`)
  - Может быть меньше, если не помещается в контейнер
  - Использовать `whitespace-normal` и `break-words` для естественного переноса
- **Заголовок и статус**: По умолчанию располагаются в колонку (`flex-col`), чтобы статус автоматически переносился на следующую строку
- Текст должен переноситься естественным образом
- Кнопки должны быть достаточно большими для touch-устройств (минимум 44x44px)
- Избегание горизонтальной прокрутки внутри второй колонки

### 4.8. Wireframe мобильной строки таблицы

```
┌─────────┬────────────────────────────────────┐
│ [::: ]  │ 1. Установка светильников         │
│         │ [Активна]                          │
│         │                                    │
│         │ Описание: Установка люстр, бра,   │
│         │ точечных светильников (макс 35   │
│         │ символов, перенос если не         │
│         │ помещается)                        │
│         │                                    │
│         │ Цена: 50.00 BYN                   │
│         │ Единица: шт                        │
│         │                                    │
│         │ [✏️] [🗑️]                        │
└─────────┴────────────────────────────────────┘
   Handle   Информация и действия
   (w-5)    (перенос содержимого)
```

**Пример для таблицы заказов:**
```
┌─────────┬────────────────────────────────────┐
│ [::: ]  │ 1. #ORD-2025-001                   │
│         │ 06.11.2025 14:30                   │
│         │ [Подтвержден]                      │
│         │                                    │
│         │ Клиент: Иван Иванов                │
│         │ Телефон: +375 29 123-45-67         │
│         │ Услуга: Установка светильников     │
│         │ Цена: 50.00 BYN                   │
│         │                                    │
│         │ [👁️]                              │
└─────────┴────────────────────────────────────┘
```

---

## 5. Универсальные паттерны реализации

### 5.1. Компонентная структура
```
TableComponent/
├── DesktopTable/          (xl:block)
│   ├── TableHeader
│   │   ├── HandleHead
│   │   ├── NumberHead
│   │   └── DataHeads...
│   └── TableBody
│       └── SortableRow (если нужен DnD)
│           ├── HandleCell
│           ├── NumberCell
│           └── DataCells...
└── MobileTable/           (xl:hidden)
    ├── TableHeader
    │   ├── HandleHead
    │   ├── NumberHead
    │   └── InfoHead
    └── TableBody
        └── SortableRow (если нужен DnD)
            ├── HandleCell
            ├── NumberCell
            └── InfoCell
                ├── PrimaryInfo
                ├── DetailedInfo
                └── Actions
```

### 5.2. Переиспользуемые компоненты
- `TableRowHandle` — handle для drag & drop (для обеих версий)
- `TableRowNumber` — номер элемента (для обеих версий)
- `TableRowInfo` — обертка для информации строки (мобильная версия)
- `TableRowPrimaryInfo` — основная информация
- `TableRowDetailedInfo` — детальная информация
- `TableRowActions` — действия и управление
- `SortableRowWrapper` — обертка для drag & drop функциональности

### 5.3. Конфигурация колонок
Определение структуры таблицы через конфигурационный объект:
```typescript
type ColumnConfig = {
  key: string;
  label: string;
  primary?: boolean;      // Отображается в primary info секции (мобильная)
  detailed?: boolean;     // Отображается в detailed info секции (мобильная)
  action?: boolean;       // Отображается в actions секции (мобильная)
  desktopWidth?: string; // Ширина на десктопе
  description?: boolean; // Является ли колонкой описания (35ch)
};
```

### 5.4. Генерация номера элемента
- Номер элемента вычисляется на основе индекса в массиве: `index + 1` (или `index` если нумерация с 0)
- При изменении порядка через Drag & Drop номера обновляются автоматически
- Номер отображается в обеих версиях (десктоп и мобильная)

**Пример:**
```tsx
{items.map((item, index) => (
  <SortableRow key={item.id} item={item} index={index} />
))}
```

---

## 6. Стилизация и доступность

### 6.1. Общие стили
- Мобильная таблица: `rounded-md border`
- Ячейки: `p-3` или `p-4` для достаточного пространства
- Отступы: консистентные `gap-2`, `space-y-2`
- Колонка номера: `text-center`, `text-muted-foreground`, `font-medium`

### 6.2. Интерактивность
- Все кнопки и ссылки кликабельны на мобильных (минимум 44x44px)
- Hover-эффекты только на десктопе (`hover:`)
- Touch-эффекты на мобильных (active states)

### 6.3. Доступность
- ARIA labels для drag handles: `aria-label="Переместить элемент"`
- Keyboard navigation для всех интерактивных элементов
- Семантическая разметка (`<table>`, `<thead>`, `<tbody>`)
- ARIA labels для колонки номера: `aria-label="Порядковый номер"`

**Пример:**
```tsx
<TableHead className="w-12 text-center" aria-label="Порядковый номер">
  №
</TableHead>
```

---

## 7. Производительность

### 7.1. Рендеринг
- Условный рендеринг через CSS (`hidden`/`block`), а не через JavaScript
- Избегание дублирования данных между десктопной и мобильной версиями
- Единая структура данных для обеих версий

### 7.2. Drag & Drop
- Единая логика для десктопной и мобильной версий
- Оптимизация через `useSortable` и `SortableContext`
- Одинаковый `SortableContext` для обеих версий
- Автоматическое обновление номеров при изменении порядка

---

## 8. Примеры применения принципов

### 8.1. Таблица услуг (десктопная версия)

```
┌──────────┬──────┬──────────────────────┬──────────────────────────┬──────────┬──────────┬──────────┬──────────┐
│          │      │                      │                          │          │          │          │          │
│ [::: ]   │  1   │ Установка            │ Установка люстр, бра,    │ 50.00    │ шт       │ [Активна]│ [✏️][🗑️]│
│          │      │ светильников         │ точечных светильников    │ BYN      │          │          │          │
│          │      │                      │                          │          │          │          │          │
├──────────┼──────┼──────────────────────┼──────────────────────────┼──────────┼──────────┼──────────┼──────────┤
│ [::: ]   │  2   │ Диагностика и ремонт │ Диагностика              │ 80.00    │ услуга   │ [Активна]│ [✏️][🗑️]│
│          │      │                      │ неисправностей и ремонт  │ BYN      │          │          │          │
│          │      │                      │ электрики                │          │          │          │          │
└──────────┴──────┴──────────────────────┴──────────────────────────┴──────────┴──────────┴──────────┴──────────┘
```

### 8.2. Таблица услуг (мобильная версия)

```
┌──────────┬──────┬────────────────────────────────────┐
│ [::: ]   │  1   │ Установка светильников           │
│          │      │                                   │
│          │      │ Описание: Установка люстр, бра,  │
│          │      │ точечных светильников            │
│          │      │                                   │
│          │      │ Цена: 50.00 BYN                  │
│          │      │ Единица: шт                       │
│          │      │                                   │
│          │      │ [Активна] [✏️] [🗑️]            │
├──────────┼──────┼────────────────────────────────────┤
│ [::: ]   │  2   │ Диагностика и ремонт             │
│          │      │                                   │
│          │      │ Описание: Диагностика            │
│          │      │ неисправностей и ремонт          │
│          │      │ электрики                        │
│          │      │                                   │
│          │      │ Цена: 80.00 BYN                  │
│          │      │ Единица: услуга                  │
│          │      │                                   │
│          │      │ [Активна] [✏️][🗑️]             │
└──────────┴──────┴────────────────────────────────────┘
```

### 8.3. Таблица заказов (десктопная версия)

```
┌──────────┬──────┬──────────────┬──────────────┬──────────────┬──────────┬──────────┬──────────┬──────────┐
│ [::: ]   │  1   │ #ORD-2025-  │ Иван         │ +375 29      │ Установка│ [Подтв.] │ 50.00    │ [👁️]    │
│          │      │ 001          │ Иванов       │ 123-45-67    │ светильн.│          │ BYN      │          │
├──────────┼──────┼──────────────┼──────────────┼──────────────┼──────────┼──────────┼──────────┼──────────┤
│ [::: ]   │  2   │ #ORD-2025-  │ Петр         │ +375 29      │ Диагност.│ [В работе]│ 80.00   │ [👁️]    │
│          │      │ 002          │ Петров       │ 234-56-78    │ и ремонт │          │ BYN      │          │
└──────────┴──────┴──────────────┴──────────────┴──────────────┴──────────┴──────────┴──────────┴──────────┘
```

### 8.4. Таблица заказов (мобильная версия)

```
┌──────────┬──────┬────────────────────────────────────┐
│ [::: ]   │  1   │ #ORD-2025-001                     │
│          │      │ 06.11.2025 14:30                  │
│          │      │ [Подтвержден]                     │
│          │      │                                   │
│          │      │ Клиент: Иван Иванов                │
│          │      │ Телефон: +375 29 123-45-67        │
│          │      │ Услуга: Установка светильников     │
│          │      │ Цена: 50.00 BYN                   │
│          │      │                                   │
│          │      │ [👁️ Просмотр]                    │
└──────────┴──────┴────────────────────────────────────┘
```

---

## 9. Чеклист реализации

При создании новой таблицы или обновлении существующей, убедитесь в следующем:

### 9.1. Структура
- [ ] Брейкпоинт 1280px используется для переключения версий
- [ ] Десктопная версия скрыта на мобильных (`hidden xl:block`)
- [ ] Мобильная версия скрыта на десктопе (`xl:hidden`)
- [ ] Колонка номера элемента присутствует в обеих версиях
- [ ] Колонка "Порядок" отсутствует (заменена номером элемента)

### 9.2. Десктопная версия
- [ ] Первая колонка: Drag & Drop Handle (`w-10`)
- [ ] Вторая колонка: Номер элемента (`w-12`, `text-center`)
- [ ] Колонка описания имеет `max-w-[35ch]` и `whitespace-normal`
- [ ] Все колонки видны без горизонтальной прокрутки
- [ ] Drag & Drop работает корректно

### 9.3. Мобильная версия
- [ ] Первая колонка: Drag & Drop Handle (`w-10`)
- [ ] Вторая колонка: Номер элемента (`w-10`, `text-center`)
- [ ] Третья колонка: Информация и действия (`flex-1`)
- [ ] Информация разделена на секции: основная → детальная → действия
- [ ] Кнопки имеют достаточный размер для touch (минимум 44x44px)
- [ ] Drag & Drop работает корректно на touch-устройствах

### 9.4. Функциональность
- [ ] Номера элементов обновляются при изменении порядка через Drag & Drop
- [ ] Все интерактивные элементы доступны и кликабельны
- [ ] Нет дублирования данных между версиями
- [ ] Единая логика Drag & Drop для обеих версий

### 9.5. Доступность
- [ ] ARIA labels для всех интерактивных элементов
- [ ] Keyboard navigation работает корректно
- [ ] Семантическая разметка используется правильно
- [ ] Контрастность цветов соответствует WCAG 2.1 AA

---

## 10. Итоговые рекомендации

1. ✅ **Единый брейкпоинт**: 1280px для всех таблиц
2. ✅ **Двухколоночная структура на мобильных**: Handle (w-5) | Информация и действия (номер в заголовке)
3. ✅ **Структура на десктопе**: Handle (w-5) | Номер (w-12) | Данные | Действия
4. ✅ **Колонка номера заменяет колонку "Порядок"** на десктопе, на мобильных номер в заголовке
5. ✅ **Вертикальное расположение информации** во второй колонке (мобильная): основная (с номером) → детальная → действия (только иконки)
6. ✅ **Drag & Drop работает на всех экранах** через единую реализацию с `suppressHydrationWarning`
7. ✅ **Описание на десктопе**: ~35 символов с переносом текста
8. ✅ **Автоматическое обновление номеров** при изменении порядка через Drag & Drop

---

**Примечание**: Эти принципы должны применяться ко всем таблицам в админ-панели (Services, Orders, FAQ, Gallery, Reviews) для обеспечения консистентного UX на всех устройствах.

